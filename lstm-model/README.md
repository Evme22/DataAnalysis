# Power Consumption Interpolation with LSTM

## Содержание
- [Описание задания](#описание-задания)
- [Цели](#цели)
- [Выполненные шаги](#выполненные-шаги)
- [Используемые технологии](#используемые-технологии)
- [Результаты](#результаты)

## Описание задания
Изучение применения рекуррентных нейронных сетей (LSTM) для интерполяции временных рядов в условиях зашумленных данных и сравнение их с классическими методами (линейная интерполяция).

В работе используется временной ряд потребления электроэнергии, загруженный с платформы Kaggle:  
[Electric Power Consumption](https://www.kaggle.com/datasets/fedesoriano/electric-power-consumption?resource=download)

## Цели
- Подготовить датасет, включая добавление шума и создание пропущенных значений.
- Реализовать и обучить модель LSTM для восстановления пропущенных значений.
- Сравнить качество интерполяции с классическими методами (например, линейная интерполяция).
- Оценить точность модели с помощью метрик MSE, MAE и R².

## Выполненные шаги
- Описание предметной области.
- Загрузка и предварительная обработка и изучение датасета powerconsumption.csv.
- Вычленение новых признаков из столбца Datatime.
- Добавляется шум к данным (в размере 2%).
- Кодирование циклических признаков (тригонометрическое кодирование).
- Нормализация числовых признаков (MinMaxScaler()).
- Создается скользящее окно (window_size = 60).
- Данные делятся на обучающую и тренировочную выборки.
- В y_test добавляются пропуски (в размере 5%).
- Создается LSTM модель (3 слоя - 100-50-1 нейронов, функция активации в выходном слое - линейная).
- Компиляция модели (оптимизатор - Adam, используется кастомная функция потерь masked_mse на основе MSE).
- Выполняются предсказания модели на тестовых данных.
- Строится график потерь для обучения и тестирования.
- Строится график изменения средней абсолютной ошибки для обучения и тестирования.
- Вывод и анализ метрик оценки качества модели MSE, MAE и R².
- Сравнительный анализ качества модели LSTM с линейной интерполяцией.

Выполненные шаги и результаты отработанных методов можно посмотреть в файле energy-consumption-interpolation или в Google Colab по ссылке ниже.

## Используемые технологии
- Python 3
- Библиотеки:
  - pandas;
  - seaborn;
  - numpy;
  - tensorflow;
  - keras;
  - matplotlib.pyplot;
  - sklearn.model_selection;
  - sklearn.preprocessing;
  - sklearn.metrics;
  - keras.models;
  - keras.layers;
  - keras.optimizers;
  - tensorflow.keras;
  - tensorflow.keras.regularizers;
- Google Colab

[![Open in Colab](https://colab.research.google.com/assets/colab-badge.svg)]
(https://colab.research.google.com/drive/1g8YD2S4bzK6Didm6MYYxTt-jOBtGmDjr?usp=sharing)

## Результаты
В ходе выполнения работы были изучены принципы работы рекуррентных нейронных сетей (LSTM) для интерполяции временных рядов энергопотребления в условиях зашумленных данных. Для выполнения использовался датасет Electric Power Consumption, содержащий информацию о потреблении электроэнергии за каждые 10 минут.

В ходе предобработки и анализа датасета были выявлены значимые признаки, удалены сомнительные признаки, нормализованы данные и добавлены шум и пропуски в датасет.

Разработанная модель LSTM продемонстрировала хорошую точность восстановления пропущенных значений в данных энергопотребления, MSE: 2204871.6211, MAE: 1108.86, R²: 0.9889. Такие результаты свидетельствуют, что модель хорошо улавливает сложные временные зависимости.

График функции потерь на тренировочных данных и тестовых также показал хорошие результаты, снижение потерь в обоих случаях, но выявил возможное переобучение.

Линейная интерполяция показала исключительную точность, MSE = 0, MAE = 0.0001, R² = 1, что может объясняться расположением пропусков на участках с почти линейным изменением потребления.
